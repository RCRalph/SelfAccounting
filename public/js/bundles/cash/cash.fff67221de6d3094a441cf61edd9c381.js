(()=>{var e={2874:(e,s,t)=>{"use strict";t.d(s,{Z:()=>i});function n(e,s,t,n,a,r,i,c){var u,o="function"==typeof e?e.options:e;if(s&&(o.render=s,o.staticRenderFns=t,o._compiled=!0),n&&(o.functional=!0),r&&(o._scopeId="data-v-"+r),i?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),a&&a.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(i)},o._ssrRegister=u):a&&(u=c?function(){a.call(this,(o.functional?this.parent:this).$root.$options.shadowRoot)}:a),u)if(o.functional){o._injectStyles=u;var l=o.render;o.render=function(e,s){return u.call(s),l(e,s)}}else{var d=o.beforeCreate;o.beforeCreate=d?[].concat(d,u):[u]}return{exports:e,options:o}}const a=n({},(function(){var e=this,s=e.$createElement;e._self._c;return e._m(0)}),[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"d-flex justify-content-center my-2"},[t("div",{staticClass:"spinner-grow",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[t("span",{staticClass:"sr-only"},[e._v("Loading...")])])])}],!1,null,null,null).exports;var r=n({props:{disableAll:{type:Boolean,required:!1,default:!1},disableSave:{type:Boolean,required:!1,default:!1},disableReset:{type:Boolean,required:!1,default:!1},spinner:{type:Boolean,required:!1,default:!1}}},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"row"},[t("div",{staticClass:"col-sm-6 my-2 my-sm-0"},[t("button",{staticClass:"big-button-success",attrs:{type:"button",disabled:e.disableAll||e.disableSave||e.spinner},on:{click:function(s){return e.$emit("save")}}},[e.spinner?t("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):t("div",[e._v("\n                Save changes\n            ")])])]),e._v(" "),t("div",{staticClass:"col-sm-6 my-2 my-sm-0"},[t("button",{staticClass:"big-button-danger",attrs:{type:"button",disabled:e.disableAll||e.disableReset||e.spinner},on:{click:function(s){return e.$emit("reset")}}},[e._v("\n            Reset changes\n        ")])])])}),[],!1,null,null,null);const i=n({components:{Loading:a,SaveResetChanges:r.exports},data:function(){return{ready:!1,currencies:[],currentCurrency:1,cash:{},means:{},cashMeans:{},cashMeansCopy:{},usersCash:{},usersCashCopy:{},saveChangesSpinner:!1}},computed:{sumOfCash:function(){var e=this;return this.disableSubmit?0:Math.round(100*this.cash[this.currentCurrency].map((function(e){return{id:e.id,value:e.value}})).map((function(s){return e.usersCash[s.id]*s.value})).reduce((function(e,s){return e+s})))/100},currentCashMeanBalance:function(){var e=this;return null!=this.cashMeans[this.currentCurrency]&&this.means[this.currentCurrency].find((function(s){return s.id==e.cashMeans[e.currentCurrency]})).balance},disableSubmit:function(){for(var e in this.usersCash)if(!this.isValidCashAmount(this.usersCash[e]))return!0;return!1}},methods:{isValidCashAmount:function(e){return""!==e&&(e=Number(e),!isNaN(e)&&(e>=0&&Math.floor(e)==e&&e<Math.pow(2,63)))},saveChanges:function(){var e=this;this.saveChangesSpinner=!0;var s=[];for(var t in this.usersCash)0!=this.usersCash[t]&&s.push({id:t,amount:this.usersCash[t]});var n=[];for(var a in this.cashMeans)null!=this.cashMeans[a]&&n.push(this.cashMeans[a]);axios.post("/webapi/bundles/cash",{usersCash:s,cashMeans:n}).then((function(){e.cashMeansCopy=_.cloneDeep(e.cashMeans),e.usersCashCopy=_.cloneDeep(e.usersCash)})).catch((function(e){console.error(e)})).finally((function(){e.saveChangesSpinner=!1}))},resetChanges:function(){this.cashMeans=_.cloneDeep(this.cashMeansCopy),this.usersCash=_.cloneDeep(this.usersCashCopy)}},mounted:function(){var e=this;axios.get("/webapi/bundles/cash",{}).then((function(s){var t=s.data;for(var n in e.currencies=t.currencies,e.currentCurrency=t.lastCurrency,e.cash=t.cash,e.means=t.means,e.cashMeans=t.cashMeans,e.cashMeansCopy=_.cloneDeep(t.cashMeans),e.cash)e.cash[n].forEach((function(e){null==t.usersCash[e.id]&&(t.usersCash[e.id]=0)}));e.usersCash=t.usersCash,e.usersCashCopy=_.cloneDeep(t.usersCash),e.ready=!0}))}},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"card"},[t("div",{staticClass:"card-header-flex"},[e._m(0),e._v(" "),e.ready?t("div",{staticClass:"d-flex"},[t("div",{staticClass:"currency-text"},[e._v("Currency:")]),e._v(" "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.currentCurrency,expression:"currentCurrency"}],staticClass:"form-control",on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.currentCurrency=s.target.multiple?t:t[0]}}},e._l(e.currencies,(function(s){return t("option",{key:s.id,domProps:{value:s.id}},[e._v("\n                        "+e._s(s.ISO)+"\n                    ")])})),0)]):e._e()]),e._v(" "),t("div",{staticClass:"card-body"},[e.ready?t("div",[t("div",{staticClass:"input-group-row"},[e._m(1),e._v(" "),t("div",{staticClass:"col-lg-5"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.cashMeans[e.currentCurrency],expression:"cashMeans[currentCurrency]"}],staticClass:"form-control",on:{change:function(s){var t=Array.prototype.filter.call(s.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.$set(e.cashMeans,e.currentCurrency,s.target.multiple?t:t[0])}}},[t("option",{domProps:{value:null,selected:null}},[e._v("N/A")]),e._v(" "),e._l(e.means[e.currentCurrency],(function(s,n){return t("option",{key:n,domProps:{value:s.id,selected:s.id}},[e._v("\n                                "+e._s(s.name)+"\n                            ")])}))],2)])]),e._v(" "),t("hr",{staticClass:"hr"}),e._v(" "),t("div",{staticClass:"row"},[t("div",{staticClass:"col-lg-10 offset-lg-1 table-responsive-lg"},[t("table",{staticClass:"table-themed responsive-table-hover"},[e._m(2),e._v(" "),t("tbody",e._l(e.cash[e.currentCurrency],(function(s,n){return t("tr",{key:n},[t("th",{staticClass:"h5 fw-bold",attrs:{scope:"row"}},[e._v("\n                                        "+e._s(Number(s.value))+" "+e._s(e.currencies[e.currentCurrency-1].ISO)+"\n                                    ")]),e._v(" "),t("td",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.usersCash[s.id],expression:"usersCash[item.id]"}],class:["cash-input",!e.isValidCashAmount(e.usersCash[s.id])&&"is-invalid"],attrs:{type:"number",step:"1",min:"0"},domProps:{value:e.usersCash[s.id]},on:{input:function(t){t.target.composing||e.$set(e.usersCash,s.id,t.target.value)}}})]),e._v(" "),t("td",{staticClass:"h5 fw-bold"},[e._v("\n                                        "+e._s(e.isValidCashAmount(e.usersCash[s.id])?Math.round(s.value*e.usersCash[s.id]*100)/100:0)+"\n\t\t\t\t\t\t\t\t\t\t"+e._s(e.currencies[e.currentCurrency-1].ISO)+"\n                                    ")])])})),0)])])]),e._v(" "),t("div",{staticClass:"row h3 fw-bold"},[t("div",{staticClass:"col-6 text-end"},[e._v("Sum:")]),e._v(" "),t("div",{staticClass:"col-6 "},[e._v(e._s(e.sumOfCash)+" "+e._s(e.currencies[e.currentCurrency-1].ISO))])]),e._v(" "),!1!==e.currentCashMeanBalance?t("div",[t("div",{staticClass:"row h3 fw-bold"},[t("div",{staticClass:"col-6 text-end"},[e._v("Current balance:")]),e._v(" "),t("div",{staticClass:"col-6 "},[e._v(e._s(e.currentCashMeanBalance)+" "+e._s(e.currencies[e.currentCurrency-1].ISO))])]),e._v(" "),t("hr",{staticClass:"hr-dashed w-100"}),e._v(" "),t("div",{class:["row","h3","fw-bold",e.currentCashMeanBalance-e.sumOfCash!=0?"text-danger":"text-success"]},[t("div",{staticClass:"col-6 text-end"},[e._v("Balance difference:")]),e._v(" "),t("div",{staticClass:"col-6"},[e._v("\n                            "+e._s(e.currentCashMeanBalance-e.sumOfCash>0?"+":"")+e._s(Math.round(100*(e.currentCashMeanBalance-e.sumOfCash))/100)+"\n                            "+e._s(e.currencies[e.currentCurrency-1].ISO)+"\n                        ")])])]):e._e(),e._v(" "),t("hr",{staticClass:"hr"}),e._v(" "),t("SaveResetChanges",{attrs:{disableSave:e.disableSubmit,spinner:e.saveChangesSpinner},on:{save:e.saveChanges,reset:e.resetChanges}})],1):t("Loading")],1)])}),[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"card-header-text"},[t("i",{staticClass:"fas fa-money-bill-wave"}),e._v("\n                Cash handling\n            ")])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"col-lg-5 d-flex justify-content-lg-end justify-content-start align-items-center"},[t("div",{staticClass:"h5 fw-bold m-lg-0"},[e._v("Mean of payment used as cash:")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("thead",[t("tr",[t("th",{staticClass:"h4 fw-bold",attrs:{scope:"col"}},[e._v("Face value")]),e._v(" "),t("th",{staticClass:"h4 fw-bold",attrs:{scope:"col"}},[e._v("Amount")]),e._v(" "),t("th",{staticClass:"h4 fw-bold",attrs:{scope:"col"}},[e._v("Value")])])])}],!1,null,null,null).exports}},s={};function t(n){var a=s[n];if(void 0!==a)return a.exports;var r=s[n]={exports:{}};return e[n](r,r.exports,t),r.exports}t.d=(e,s)=>{for(var n in s)t.o(s,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:s[n]})},t.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{Vue.component("cash-component",t(2874).Z);new Vue({el:"#app"})})()})();
//# sourceMappingURL=cash.js.map