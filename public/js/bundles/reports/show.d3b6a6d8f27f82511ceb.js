(()=>{var t={1183:(t,e,r)=>{"use strict";r.d(e,{Z:()=>u});function n(t,e,r,n,a,s,i,o){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=r,l._compiled=!0),n&&(l.functional=!0),s&&(l._scopeId="data-v-"+s),i?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),a&&a.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(i)},l._ssrRegister=c):a&&(c=o?function(){a.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:a),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:l}}const a=n({props:{cells:Array}},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("tr",t._l(t.cells,(function(e,n){return r("th",{key:n,class:e.text&&"h5 fw-bold",attrs:{scope:e.text&&"col","data-bs-toggle":e.tooltip&&"tooltip","data-bs-placement":e.tooltip&&"bottom",title:e.tooltip}},[t._v("\n            "+t._s(e.text)+"\n        ")])})),0)])}),[],!1,null,null,null).exports;const s=n({},(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h1",{staticClass:"text-center"},[t._v("Nothing to see here, for now...")])])}],!1,null,null,null).exports;var i=n({},(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"d-flex justify-content-center my-2"},[r("div",{staticClass:"spinner-grow",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[r("span",{staticClass:"sr-only"},[t._v("Loading...")])])])}],!1,null,null,null);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){l(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const u=n({props:["id","edit"],components:{TableHeader:a,EmptyPlaceholder:s,Loading:i.exports},data:function(){return{data:{},currencies:[],means:{},categories:{},rows:[],sum:null,sumCurrency:1,columnNames:[],ready:!1}},computed:{headerCells:function(){var t=this,e=[];return this.columnNames.forEach((function(r){t.data.columns[r]&&e.push({text:r.charAt(0).toUpperCase()+r.slice(1)})})),e},tableRowsSpanned:function(){var t=this,e=[],r={},n={date:1,title:1,amount:1,price:1,value:1,category_id:1,mean_id:1,currency_id:1};return this.rows.forEach((function(a,s){var i=_.cloneDeep(a);if(t.data.columns.value&&(i.value=Number(i.value).toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}).split(",").join(" ")),t.data.columns.amount&&(i.amount=Number(i.amount).toLocaleString("en",{minimumFractionDigits:0,maximumFractionDigits:3}).split(",").join(" ")),t.data.columns.price&&(i.price=Number(i.price).toLocaleString("en",{minimumFractionDigits:2,maximumFractionDigits:2}).split(",").join(" ")),!e.length)return e.push(c(c({},i),{},{span:c({},n)})),void(r=c(c({},i),{},{span:c({},n),indeces:{date:0,title:0,amount:0,price:0,value:0,category_id:0,mean_id:0,currency_id:0}}));if(i.date!=r.date)e.push(c(c({},i),{},{span:c({},n)})),r=c(c({},i),{},{span:c({},n),indeces:{date:s,title:s,amount:s,price:s,value:s,category_id:s,mean_id:s,currency_id:s}});else{var o={span:{}};for(var l in i)i[l]==r[l]?e[r.indeces[l]].span[l]++:(o[l]=i[l],o.span[l]=1,r[l]=i[l],r.indeces[l]=s);e.push(o)}})),e}},methods:{getCategoryName:function(t,e){if(!e)return"N/A";var r=this.categories[t].find((function(t){return t.id==e}));return r?r.name:"N/A"},getMeanName:function(t,e){if(!e)return"N/A";var r=this.means[t].find((function(t){return t.id==e}));return r?r.name:"N/A"},exportToTXT:function(){var t=this,e=[this.columnNames.map((function(e){if(t.data.columns[e])return e.charAt(0).toUpperCase()+e.slice(1)})).join("%09")];this.rows.forEach((function(r,n){var a=t.columnNames.map((function(e,a){if(t.data.columns[e])return a<=2?r[e]:a<=4?r[e]+" "+t.currencies[t.rows[n].currency_id-1].ISO:5==a?t.getCategoryName(t.rows[n].currency_id,r.category_id):t.getMeanName(t.rows[n].currency_id,r.mean_id)})).join("%09");e.push(a)}));var r=e.join("%0A"),n=document.createElement("a");n.style.display="none;",n.href="data:text/plain;charset:utf-8,".concat(r),n.download="".concat(this.data.title,".txt"),document.body.appendChild(n),n.click(),document.body.removeChild(n)}},mounted:function(){var t=this;axios.get("/webapi/bundles/reports/".concat(this.id),{}).then((function(e){t.currencies=e.data.currencies,t.means=e.data.means,t.categories=e.data.categories,t.data=e.data.reportData,t.rows=e.data.rows,t.sum=e.data.sum,t.columnNames=e.data.columnNames,null!==e.data.sum&&(t.sumCurrency=Object.keys(e.data.sum),t.sumCurrency=t.sumCurrency.length?t.sumCurrency[0]:0),t.ready=!0}))},updated:function(){this.$nextTick((function(){document.getElementById("table-multi-hover")&&tableHovering()}))}},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card"},[r("div",{staticClass:"card-header-flex"},[r("div",{staticClass:"card-header-text"},[r("i",{staticClass:"fas fa-newspaper"}),t._v("\n            "+t._s(t.ready?t.data.title:"Report #"+t.id)+"\n        ")]),t._v(" "),t.ready&&"1"==t.edit?r("div",{staticClass:"d-flex"},[r("a",{staticClass:"big-button-primary",attrs:{role:"button",href:"/bundles/reports/"+t.id+"/edit"}},[t._v("\n                Edit report\n            ")])]):t._e()]),t._v(" "),r("div",{staticClass:"card-body"},[t.ready?r("div",[t.rows.length?r("div",[null!==t.sum?r("div",{staticClass:"row"},[r("div",{staticClass:"mx-auto mb-3 col-md-8 col-lg-6 offset-lg-3"},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-header-flex"},[t._m(0),t._v(" "),Object.keys(t.sum).length>1?r("div",{staticClass:"d-flex"},[r("div",{staticClass:"currency-text"},[t._v("Currency:")]),t._v(" "),r("select",{directives:[{name:"model",rawName:"v-model",value:t.sumCurrency,expression:"sumCurrency"}],staticClass:"form-control",on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.sumCurrency=e.target.multiple?r:r[0]}}},t._l(Object.keys(t.sum),(function(e,n){return r("option",{key:n,domProps:{value:e}},[t._v("\n                                            "+t._s(t.currencies[e-1].ISO)+"\n                                        ")])})),0)]):t._e()]),t._v(" "),r("div",{staticClass:"card-body text-center h2 my-auto"},[t._v("\n                                "+t._s(t.sum[t.sumCurrency].toLocaleString("en").split(",").join(" "))+"\n                                "+t._s(t.currencies[t.sumCurrency-1].ISO)+"\n                            ")])])])]):t._e(),t._v(" "),r("div",{staticClass:"row mb-3"},[r("div",{staticClass:"col-lg-4 col-md-6 col-12 my-2 my-md-0 offset-lg-4 offset-md-3"},[r("button",{staticClass:"big-button-primary btn-lg",on:{click:t.exportToTXT}},[r("i",{staticClass:"fas fa-file-alt"}),t._v("\n                            Export to .txt file\n                        ")])])]),t._v(" "),r("div",{staticClass:"table-responsive w-100"},[r("table",{staticClass:"table-themed responsive-table-bordered",attrs:{id:"table-multi-hover"}},[r("TableHeader",{attrs:{cells:t.headerCells}}),t._v(" "),r("tbody",t._l(t.tableRowsSpanned,(function(e,n){return r("tr",{key:n,attrs:{i:n}},[e.date?r("th",{attrs:{scope:"row",rep:"date",rowspan:e.span.date}},[t._v(t._s(e.date)+"\n                                ")]):t._e(),t._v(" "),e.title?r("td",{attrs:{rep:"title",rowspan:e.span.title}},[t._v(t._s(e.title))]):t._e(),t._v(" "),e.amount?r("td",{attrs:{rep:"amount",rowspan:e.span.amount}},[t._v(t._s(e.amount))]):t._e(),t._v(" "),e.price?r("td",{attrs:{rep:"price",rowspan:e.span.price}},[t._v(t._s(e.price+" "+t.currencies[t.rows[n].currency_id-1].ISO))]):t._e(),t._v(" "),e.value?r("td",{attrs:{rep:"value",rowspan:e.span.value}},[t._v(t._s(e.value+" "+t.currencies[t.rows[n].currency_id-1].ISO))]):t._e(),t._v(" "),void 0!==e.category_id?r("td",{attrs:{rep:"category",rowspan:e.span.category_id}},[t._v(t._s(t.getCategoryName(t.rows[n].currency_id,e.category_id)))]):t._e(),t._v(" "),void 0!==e.mean_id?r("td",{attrs:{rep:"mean",rowspan:e.span.mean_id}},[t._v(t._s(t.getMeanName(t.rows[n].currency_id,e.mean_id)))]):t._e()])})),0)],1)])]):r("EmptyPlaceholder")],1):r("Loading")],1)])}),[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"card-header-text"},[r("i",{staticClass:"fas fa-calculator"}),t._v("\n                                    Sum\n                                ")])}],!1,null,null,null).exports}},e={};function r(n){var a=e[n];if(void 0!==a)return a.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,r),s.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{Vue.component("show-report-component",r(1183).Z);new Vue({el:"#app"})})()})();
//# sourceMappingURL=show.js.map