!function(t){var e={};function n(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(a,o,function(e){return t[e]}.bind(null,o));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=59)}({0:function(t,e,n){"use strict";function a(t,e,n,a,o,s,r,c){var i,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),a&&(l.functional=!0),s&&(l._scopeId="data-v-"+s),r?(i=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},l._ssrRegister=i):o&&(i=c?function(){o.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:o),i)if(l.functional){l._injectStyles=i;var d=l.render;l.render=function(t,e){return i.call(e),d(t,e)}}else{var u=l.beforeCreate;l.beforeCreate=u?[].concat(u,i):[i]}return{exports:t,options:l}}n.d(e,"a",(function(){return a}))},1:function(t,e,n){"use strict";var a=n(0),o=Object(a.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"d-flex justify-content-center my-2"},[e("div",{staticClass:"spinner-grow",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[e("span",{staticClass:"sr-only"},[this._v("Loading...")])])])}],!1,null,null,null);e.a=o.exports},2:function(t,e,n){"use strict";var a=n(0),o=Object(a.a)({},(function(){var t=this.$createElement;this._self._c;return this._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("h1",{staticClass:"text-center"},[this._v("Nothing to see here, for now...")])])}],!1,null,null,null);e.a=o.exports},59:function(t,e,n){t.exports=n(60)},6:function(t,e,n){"use strict";var a={props:{cells:Array}},o=n(0),s=Object(o.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",t._l(t.cells,(function(e,a){return n("th",{key:a,class:e.text&&"h5 font-weight-bold",attrs:{scope:e.text&&"col","data-toggle":e.tooltip&&"tooltip","data-placement":e.tooltip&&"bottom",title:e.tooltip}},[t._v("\n            "+t._s(e.text)+"\n        ")])})),0)])}),[],!1,null,null,null);e.a=s.exports},60:function(t,e,n){Vue.component("settings-component",n(89).default);new Vue({el:"#app"})},7:function(t,e,n){"use strict";var a={props:{checked:Boolean,disabled:Boolean,name:String},methods:{emitEvents:function(t){this.$emit("input",t.currentTarget.checked),this.$emit("htmlElement",t.currentTarget)}}},o=n(0),s=Object(o.a)(a,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"slider-checkbox"},[e("label",{staticClass:"switch m-0"},[e("input",{attrs:{type:"checkbox",disabled:this.disabled,name:this.name},domProps:{checked:this.checked},on:{change:this.emitEvents}}),this._v(" "),e("span",{staticClass:"slider round"})])])}),[],!1,null,null,null);e.a=s.exports},89:function(t,e,n){"use strict";n.r(e);var a=n(6),o=n(7),s={props:{content:Object,index:Number},components:{Slider:o.a},data:function(){return{componentKey:0}},methods:{updateComponentKey:function(){this.componentKey++,this.$emit("update")}},computed:{correctDates:function(){return this.componentKey,!!(!this.content.start_date||!this.content.end_date)||new Date(this.content.start_date).getTime()<=new Date(this.content.end_date).getTime()}}},r=n(0),c=Object(r.a)(s,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{attrs:{i:t.index}},[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content.name,expression:"content.name"}],key:t.componentKey,class:["form-text",(!t.content.name.length||t.content.name.length>32)&&"is-invalid"],attrs:{type:"text",placeholder:"Name",maxlength:"32"},domProps:{value:t.content.name},on:{change:t.updateComponentKey,input:function(e){e.target.composing||t.$set(t.content,"name",e.target.value)}}})]),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.income_category},model:{value:t.content.income_category,callback:function(e){t.$set(t.content,"income_category",e)},expression:"content.income_category"}})],1),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.outcome_category},model:{value:t.content.outcome_category,callback:function(e){t.$set(t.content,"outcome_category",e)},expression:"content.outcome_category"}})],1),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.show_on_charts},model:{value:t.content.show_on_charts,callback:function(e){t.$set(t.content,"show_on_charts",e)},expression:"content.show_on_charts"}})],1),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.count_to_summary},on:{input:t.updateComponentKey},model:{value:t.content.count_to_summary,callback:function(e){t.$set(t.content,"count_to_summary",e)},expression:"content.count_to_summary"}})],1),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content.start_date,expression:"content.start_date"}],key:t.componentKey,class:["form-date",!t.correctDates&&"is-invalid"],attrs:{type:"date",disabled:!t.content.count_to_summary},domProps:{value:t.content.start_date},on:{change:t.updateComponentKey,input:function(e){e.target.composing||t.$set(t.content,"start_date",e.target.value)}}})]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content.end_date,expression:"content.end_date"}],key:t.componentKey,class:["form-date",!t.correctDates&&"is-invalid"],attrs:{type:"date",disabled:!t.content.count_to_summary},domProps:{value:t.content.end_date},on:{change:t.updateComponentKey,input:function(e){e.target.composing||t.$set(t.content,"end_date",e.target.value)}}})]),t._v(" "),n("td",{staticClass:"trashbin",on:{click:function(e){return t.$emit("delete",t.index)}}},[n("i",{staticClass:"fas fa-trash"})])])}),[],!1,null,null,null).exports,i=n(2),l={components:{TableHeader:a.a,TableBody:c,EmptyPlaceholder:i.a},props:{darkmode:Boolean,buttonsEnabled:Boolean,content:Array},data:function(){return{headerCells:[{text:"Name",tooltip:"The name of your category"},{text:"Income",tooltip:"Use in income"},{text:"Outcome",tooltip:"Use in outcome"},{text:"Charts",tooltip:"Display on charts"},{text:"Summary",tooltip:"Count to summary"},{text:"Start date",tooltip:"Count from this date"},{text:"End date",tooltip:"Count to this date"},{}],saveButton:"Save changes"}},methods:{dataSave:function(){this.saveButton='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',this.$emit("data-save")},updateData:function(){this.$emit("data-change")}}},d=Object(r.a)(l,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.darkmode?"dark-card":"card"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[null!=t.content&&t.content.length>0?n("div",{staticClass:"table-responsive-xl w-100"},[n("table",{class:["responsive-table-hover",t.darkmode?"table-darkmode":"table-lightmode"]},[n("TableHeader",{attrs:{cells:t.headerCells}}),t._v(" "),n("tbody",t._l(t.content,(function(e,a){return n("TableBody",{key:a,attrs:{content:e,index:a},on:{delete:function(e){return t.$emit("data-delete",a)},update:t.updateData}})})),1)],1)]):n("EmptyPlaceholder"),t._v(" "),n("hr"),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"big-button-primary",attrs:{disabled:!t.buttonsEnabled},on:{click:function(e){return t.$emit("data-add")}}},[t._v("\n                    New category\n                ")])]),t._v(" "),n("div",{staticClass:"col-md-4 my-2 my-md-0"},[n("button",{staticClass:"big-button-danger",attrs:{disabled:!t.buttonsEnabled},on:{click:function(e){return t.$emit("data-reset")}}},[t._v("\n                    Reset changes\n                ")])]),t._v(" "),n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"big-button-success",attrs:{disabled:!t.buttonsEnabled},domProps:{innerHTML:t._s(t.saveButton)},on:{click:t.dataSave}})])])],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header-flex"},[e("div",{staticClass:"card-header-text"},[e("i",{staticClass:"fab fa-buffer"}),this._v("\n            Categories\n        ")])])}],!1,null,null,null).exports,u={props:{content:Object,index:Number},components:{Slider:o.a},data:function(){return{componentKey:0}},methods:{updateComponentKey:function(){this.componentKey++,this.$emit("update")}},computed:{correctDate:function(){this.componentKey;var t=!this.content.first_entry_date;return null==this.content.date_limit&&!t||!t&&new Date(this.content.first_entry_date)<=new Date(this.content.date_limit)}}},m=Object(r.a)(u,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{attrs:{i:t.index}},[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content.name,expression:"content.name"}],key:t.componentKey,class:["form-text",(!t.content.name.length||t.content.name.length>32)&&"is-invalid"],attrs:{type:"text",placeholder:"Name",maxlength:"32"},domProps:{value:t.content.name},on:{change:t.updateComponentKey,input:function(e){e.target.composing||t.$set(t.content,"name",e.target.value)}}})]),n("td",[n("Slider",{attrs:{checked:t.content.income_mean},model:{value:t.content.income_mean,callback:function(e){t.$set(t.content,"income_mean",e)},expression:"content.income_mean"}})],1),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.outcome_mean},model:{value:t.content.outcome_mean,callback:function(e){t.$set(t.content,"outcome_mean",e)},expression:"content.outcome_mean"}})],1),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.show_on_charts},model:{value:t.content.show_on_charts,callback:function(e){t.$set(t.content,"show_on_charts",e)},expression:"content.show_on_charts"}})],1),t._v(" "),n("td",[n("Slider",{attrs:{checked:t.content.count_to_summary},model:{value:t.content.count_to_summary,callback:function(e){t.$set(t.content,"count_to_summary",e)},expression:"content.count_to_summary"}})],1),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content.first_entry_date,expression:"content.first_entry_date"}],key:t.componentKey,class:["form-date",!t.correctDate&&"is-invalid"],attrs:{type:"date"},domProps:{value:t.content.first_entry_date},on:{change:t.updateComponentKey,input:function(e){e.target.composing||t.$set(t.content,"first_entry_date",e.target.value)}}})]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.content.first_entry_amount,expression:"content.first_entry_amount"}],key:t.componentKey,class:["form-text",parseFloat(t.content.first_entry_amount)!=t.content.first_entry_amount&&"is-invalid"],attrs:{type:"number",step:".01"},domProps:{value:t.content.first_entry_amount},on:{change:t.updateComponentKey,input:function(e){e.target.composing||t.$set(t.content,"first_entry_amount",e.target.value)}}})]),t._v(" "),n("td",{staticClass:"trashbin",on:{click:function(e){return t.$emit("delete",t.index)}}},[n("i",{staticClass:"fas fa-trash"})])])}),[],!1,null,null,null).exports,p={components:{TableHeader:a.a,TableBody:m,EmptyPlaceholder:i.a},props:{darkmode:Boolean,buttonsEnabled:Boolean,content:Array},data:function(){return{headerCells:[{text:"Name",tooltip:"The name of your mean of payment"},{text:"Income",tooltip:"Use in income"},{text:"Outcome",tooltip:"Use in outcome"},{text:"Charts",tooltip:"Display on charts"},{text:"Summary",tooltip:"Count to summary"},{text:"First entry",tooltip:"Date from which to add the starting balance"},{text:"Starting balance",tooltip:"Amount which to use for the first entry"},{}],saveButton:"Save changes"}},methods:{dataSave:function(){this.saveButton='<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>',this.$emit("data-save")},updateData:function(){this.$emit("data-change")}}};function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function f(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){v(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function v(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var y={components:{Categories:d,Means:Object(r.a)(p,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.darkmode?"dark-card":"card"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[null!=t.content&&t.content.length>0?n("div",{staticClass:"table-responsive-xl w-100"},[n("table",{class:["responsive-table-hover",t.darkmode?"table-darkmode":"table-lightmode"]},[n("TableHeader",{attrs:{cells:t.headerCells}}),t._v(" "),n("tbody",t._l(t.content,(function(e,a){return n("TableBody",{key:a,attrs:{content:e,index:a},on:{delete:function(e){return t.$emit("data-delete",a)},update:t.updateData}})})),1)],1)]):n("EmptyPlaceholder"),t._v(" "),n("hr"),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"big-button-primary",attrs:{disabled:!t.buttonsEnabled},on:{click:function(e){return t.$emit("data-add")}}},[t._v("\n                    New mean of payment\n                ")])]),t._v(" "),n("div",{staticClass:"col-md-4 my-2 my-md-0"},[n("button",{staticClass:"big-button-danger",attrs:{disabled:!t.buttonsEnabled},on:{click:function(e){return t.$emit("data-reset")}}},[t._v("\n                    Reset changes\n                ")])]),t._v(" "),n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"big-button-success",attrs:{disabled:!t.buttonsEnabled},domProps:{innerHTML:t._s(t.saveButton)},on:{click:t.dataSave}})])])],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header-flex"},[e("div",{staticClass:"card-header-text"},[e("i",{staticClass:"fas fa-coins"}),this._v("\n            Means of Payment\n        ")])])}],!1,null,null,null).exports,Loading:n(1).a},data:function(){return{currencies:[],ready:!1,currentCurrency:1,darkmode:!1,componentKey:0,categories:{},categoriesCopy:{},axiosCategories:!0,means:{},meansCopy:{},axiosMeans:!0}},computed:{categoriesCanSave:function(){for(var t in this.componentKey,this.categories)for(var e=0;e<this.categories[t].length;e++){var n=this.categories[t][e],a=!!(!n.start_date||!n.end_date)||new Date(n.start_date).getTime()<=new Date(n.end_date).getTime();if(n.name.length>32||!n.name.length||!a)return!1}return!0},meansCanSave:function(){for(var t in this.componentKey,this.means)for(var e=0;e<this.means[t].length;e++){var n=this.means[t][e];if(n.name.length>32||!n.name.length||!n.first_entry_date||new Date(n.first_entry_date)>new Date(n.date_limit)&&null!=n.date_limit||parseFloat(n.first_entry_amount)!=n.first_entry_amount)return!1}return!0}},methods:{categoriesReset:function(){this.categories=_.cloneDeep(this.categoriesCopy),this.componentKey++},categoriesAdd:function(){this.currentCurrency in this.categories||(this.categories[this.currentCurrency]=[]),this.categories[this.currentCurrency].push({count_to_summary:!1,currency_id:this.currentCurrency,end_date:null,id:null,income_category:!1,name:"",outcome_category:!1,show_on_charts:!1,start_date:null}),this.componentKey++},categoriesDelete:function(t){this.categories[this.currentCurrency].splice(t,1),this.componentKey++},categoriesSave:function(){var t=this;this.axiosCategories=!1,axios.post("/webapi/settings/categories",{categories:this.categories}).then((function(e){t.categories=f({},_.cloneDeep(e.data.categories)),t.categoriesCopy=f({},_.cloneDeep(e.data.categories)),t.componentKey++,t.axiosCategories=!0})).catch((function(){t.axiosCategories=!0,t.componentKey++}))},meansReset:function(){this.means=_.cloneDeep(this.meansCopy),this.componentKey++},meansAdd:function(){this.currentCurrency in this.means||(this.means[this.currentCurrency]=[]),this.means[this.currentCurrency].push({count_to_summary:!1,currency_id:this.currentCurrency,first_entry_date:null,first_entry_amount:0,id:null,income_mean:!1,name:"",outcome_mean:!1,show_on_charts:!1}),this.componentKey++},meansDelete:function(t){this.means[this.currentCurrency].splice(t,1),this.componentKey++},meansSave:function(){var t=this;this.axiosMeans=!1,axios.post("/webapi/settings/means",{means:this.means}).then((function(e){t.means=f({},_.cloneDeep(e.data.means)),t.meansCopy=f({},_.cloneDeep(e.data.means)),t.componentKey++,t.axiosMeans=!0})).catch((function(){t.axiosMeans=!0,t.componentKey++}))},updateKey:function(){this.componentKey++}},beforeMount:function(){this.darkmode=document.getElementById("darkmode-status").innerHTML.includes("1")},mounted:function(){var t=this;axios.get("/webapi/settings",{}).then((function(e){t.currencies=e.data.currencies,t.currentCurrency=e.data.lastCurrency,t.categories=f({},e.data.categories),t.categoriesCopy=_.cloneDeep(f({},e.data.categories)),t.means=f({},e.data.means),t.meansCopy=_.cloneDeep(f({},e.data.means)),t.ready=!0,t.$nextTick((function(){$('[data-toggle="tooltip"]').tooltip()}))}))},beforeUpdate:function(){this.darkmode=document.getElementById("darkmode-status").innerHTML.includes("1")},updated:function(){this.$nextTick((function(){$('[data-toggle="tooltip"]').tooltip()}))}},g=Object(r.a)(y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.darkmode?"dark-card":"card"},[n("div",{staticClass:"card-header-flex"},[t._m(0),t._v(" "),t.ready?n("div",{staticClass:"d-flex"},[n("div",{staticClass:"h4 my-auto mr-3"},[t._v("Currency:")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCurrency,expression:"currentCurrency"}],staticClass:"form-control",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.currentCurrency=e.target.multiple?n:n[0]}}},t._l(t.currencies,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.ISO)+"\n                ")])})),0)]):t._e()]),t._v(" "),n("div",{staticClass:"card-body"},[t.ready?n("div",[n("Categories",{key:t.componentKey,attrs:{content:t.categories[t.currentCurrency],darkmode:t.darkmode,buttonsEnabled:t.axiosCategories&&t.categoriesCanSave},on:{"data-reset":t.categoriesReset,"data-add":t.categoriesAdd,"data-delete":t.categoriesDelete,"data-save":t.categoriesSave,"data-change":t.updateKey}}),t._v(" "),n("Means",{key:t.componentKey+1,staticClass:"mt-4",attrs:{content:t.means[t.currentCurrency],darkmode:t.darkmode,buttonsEnabled:t.axiosMeans&&t.meansCanSave},on:{"data-reset":t.meansReset,"data-add":t.meansAdd,"data-delete":t.meansDelete,"data-save":t.meansSave,"data-change":t.updateKey}})],1):n("Loading")],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header-text"},[e("i",{staticClass:"fas fa-cog"}),this._v("\n            Settings\n        ")])}],!1,null,null,null);e.default=g.exports}});
//# sourceMappingURL=settings.js.map