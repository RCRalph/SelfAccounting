(()=>{var t={1416:(t,e,n)=>{"use strict";n.d(e,{Z:()=>m});function a(t,e,n,a,s,r,o,i){var c,l="function"==typeof t?t.options:t;if(e&&(l.render=e,l.staticRenderFns=n,l._compiled=!0),a&&(l.functional=!0),r&&(l._scopeId="data-v-"+r),o?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),s&&s.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(o)},l._ssrRegister=c):s&&(c=i?function(){s.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:s),c)if(l.functional){l._injectStyles=c;var u=l.render;l.render=function(t,e){return c.call(e),u(t,e)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:t,options:l}}const s=a({},(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex justify-content-center my-2"},[n("div",{staticClass:"spinner-grow",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[n("span",{staticClass:"sr-only"},[t._v("Loading...")])])])}],!1,null,null,null).exports;const r=a({props:{cells:Array}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",t._l(t.cells,(function(e,a){return n("th",{key:a,class:e.text&&"h5 font-weight-bold",attrs:{scope:e.text&&"col","data-bs-toggle":e.tooltip&&"tooltip","data-bs-placement":e.tooltip&&"bottom",title:e.tooltip}},[t._v("\n            "+t._s(e.text)+"\n        ")])})),0)])}),[],!1,null,null,null).exports;const o=a({},(function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h1",{staticClass:"text-center"},[t._v("Nothing to see here, for now...")])])}],!1,null,null,null).exports;const i=a({props:{value:{required:!0,type:Boolean},disabled:{required:!1,type:Boolean,default:!1},name:{required:!1,type:String,default:""},choice:{type:Boolean,required:!1,default:!1}},methods:{emitEvents:function(t){this.$emit("input",t.currentTarget.checked),this.$emit("htmlElement",t.currentTarget)}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.choice?"slider-choice":"slider-checkbox"},[n("label",{staticClass:"switch m-0"},[n("input",{attrs:{type:"checkbox",disabled:t.disabled,name:t.name},domProps:{checked:t.value},on:{change:t.emitEvents}}),t._v(" "),n("span",{staticClass:"slider round"})])])}),[],!1,null,null,null).exports;const c=a({props:{value:{required:!0,type:Object},index:{required:!0,type:Number}},components:{Slider:i},computed:{validName:function(){var t=this.value.name;return t&&t.length<=32},validDates:function(){return!(this.value.start_date&&this.value.end_date)||new Date(this.value.start_date).getTime()<=new Date(this.value.end_date).getTime()}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{attrs:{i:t.index}},[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.name,expression:"value.name"}],class:["form-text",!t.validName&&"is-invalid"],attrs:{type:"text",placeholder:"Name...",maxlength:"32"},domProps:{value:t.value.name},on:{input:function(e){e.target.composing||t.$set(t.value,"name",e.target.value)}}})]),t._v(" "),n("td",[n("Slider",{model:{value:t.value.income_category,callback:function(e){t.$set(t.value,"income_category",e)},expression:"value.income_category"}})],1),t._v(" "),n("td",[n("Slider",{model:{value:t.value.outcome_category,callback:function(e){t.$set(t.value,"outcome_category",e)},expression:"value.outcome_category"}})],1),t._v(" "),n("td",[n("Slider",{model:{value:t.value.count_to_summary,callback:function(e){t.$set(t.value,"count_to_summary",e)},expression:"value.count_to_summary"}})],1),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.start_date,expression:"value.start_date"}],class:["form-date",!t.validDates&&"is-invalid"],attrs:{type:"date",disabled:!t.value.count_to_summary},domProps:{value:t.value.start_date},on:{input:function(e){e.target.composing||t.$set(t.value,"start_date",e.target.value)}}})]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.end_date,expression:"value.end_date"}],class:["form-date",!t.validDates&&"is-invalid"],attrs:{type:"date",disabled:!t.value.count_to_summary},domProps:{value:t.value.end_date},on:{input:function(e){e.target.composing||t.$set(t.value,"end_date",e.target.value)}}})]),t._v(" "),n("td",{staticClass:"trashbin",on:{click:function(e){return t.$emit("delete")}}},[n("i",{staticClass:"fas fa-trash"})])])}),[],!1,null,null,null).exports;const l=a({props:{categories:{required:!0,type:Object},currency:{required:!0,type:Number}},components:{TableHeader:r,EmptyPlaceholder:o,CategoriesTableRow:c},data:function(){return{header:[{text:"Name",tooltip:"The name of your category"},{text:"Income",tooltip:"Use in income"},{text:"Outcome",tooltip:"Use in outcome"},{text:"Summary",tooltip:"Count to summary"},{text:"Start date",tooltip:"Count from this date"},{text:"End date",tooltip:"Count to this date"},{}],content:{},contentCopy:{},submitted:!1}},computed:{equalContent:function(){return _.isEqual(this.content,this.contentCopy)},canSave:function(){var t=[];for(var e in this.content)t=t.concat(this.content[e].map((function(t){var e=t.name&&t.name.length<=32,n=!(t.start_date&&t.end_date)||new Date(t.start_date).getTime()<=new Date(t.end_date).getTime();return e&&n})));return!t.length||!!t.reduce((function(t,e){return t&&e}))}},methods:{create:function(){void 0===this.content[this.currency]&&(this.content[this.currency]=[]),this.content[this.currency].push({id:0,currency_id:this.currency,name:"",income_category:!1,outcome_category:!1,count_to_summary:!1,start_date:"",end_date:""})},remove:function(t){this.content[this.currency].splice(t,1)},reset:function(){this.content=_.cloneDeep(this.contentCopy)},submit:function(){var t=this;this.submitted=!0,axios.post("/webapi/settings/categories",{data:this.content}).then((function(e){var n=e.data;t.content=n.data,t.contentCopy=_.cloneDeep(n.data),t.submitted=!1})).catch((function(e){console.log(e),t.submitted=!1}))},refreshTooltip:function(){this.$nextTick((function(){updateTooltips()}))}},beforeMount:function(){this.content=_.cloneDeep(this.categories),this.contentCopy=_.cloneDeep(this.categories)},mounted:function(){this.refreshTooltip()},updated:function(){this.refreshTooltip()}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[n("div",[t.content[t.currency].length?n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table-themed responsive-table-hover"},[n("TableHeader",{attrs:{cells:t.header}}),t._v(" "),n("tbody",t._l(t.content[t.currency],(function(e,a){return n("CategoriesTableRow",{key:a,attrs:{index:a},on:{delete:function(e){return t.remove(a)}},model:{value:t.content[t.currency][a],callback:function(e){t.$set(t.content[t.currency],a,e)},expression:"content[currency][i]"}})})),1)],1)]):n("EmptyPlaceholder")],1),t._v(" "),n("hr",{staticClass:"hr"}),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"big-button-primary",attrs:{disabled:t.submitted},on:{click:t.create}},[t._v("\n                    New category\n                ")])]),t._v(" "),n("div",{staticClass:"col-md-4 my-2 my-md-0"},[n("button",{staticClass:"big-button-danger",attrs:{disabled:t.submitted},on:{click:t.reset}},[t._v("\n                    Reset changes\n                ")])]),t._v(" "),n("div",{staticClass:"col-md-4"},[n("button",{class:["big-button-success",!t.equalContent&&!t.submitted&&"text-stand-out"],attrs:{disabled:!t.canSave||t.submitted},on:{click:t.submit}},[t.submitted?n("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):n("div",[t._v("\n                        Save changes\n                    ")])])])])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-header-flex"},[n("div",{staticClass:"card-header-text"},[n("i",{staticClass:"fab fa-buffer"}),t._v("\n            Categories\n        ")])])}],!1,null,null,null).exports;const u=a({props:{value:{required:!0,type:Object},index:{required:!0,type:Number}},components:{Slider:i},computed:{validName:function(){var t=this.value.name;return t&&t.length<=32},validDate:function(){var t=this.value.first_entry_date;return t&&(new Date(t).getTime()<=new Date(this.value.date_limit).getTime()||null===this.value.date_limit)},validAmount:function(){var t=Number(this.value.first_entry_amount);return""!==this.value.first_entry_amount&&Math.abs(t)<=99999999999.99}}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{attrs:{i:t.index}},[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.name,expression:"value.name"}],class:["form-text",!t.validName&&"is-invalid"],attrs:{type:"text",placeholder:"Name...",maxlength:"32"},domProps:{value:t.value.name},on:{input:function(e){e.target.composing||t.$set(t.value,"name",e.target.value)}}})]),t._v(" "),n("td",[n("Slider",{model:{value:t.value.income_mean,callback:function(e){t.$set(t.value,"income_mean",e)},expression:"value.income_mean"}})],1),t._v(" "),n("td",[n("Slider",{model:{value:t.value.outcome_mean,callback:function(e){t.$set(t.value,"outcome_mean",e)},expression:"value.outcome_mean"}})],1),t._v(" "),n("td",[n("Slider",{model:{value:t.value.count_to_summary,callback:function(e){t.$set(t.value,"count_to_summary",e)},expression:"value.count_to_summary"}})],1),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.first_entry_date,expression:"value.first_entry_date"}],class:["form-date",!t.validDate&&"is-invalid"],attrs:{type:"date"},domProps:{value:t.value.first_entry_date},on:{input:function(e){e.target.composing||t.$set(t.value,"first_entry_date",e.target.value)}}})]),t._v(" "),n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.value.first_entry_amount,expression:"value.first_entry_amount"}],class:["form-date",!t.validAmount&&"is-invalid"],attrs:{type:"number",step:"0.01"},domProps:{value:t.value.first_entry_amount},on:{input:function(e){e.target.composing||t.$set(t.value,"first_entry_amount",e.target.value)}}})]),t._v(" "),n("td",{staticClass:"trashbin",on:{click:function(e){return t.$emit("delete")}}},[n("i",{staticClass:"fas fa-trash"})])])}),[],!1,null,null,null).exports;var d=a({props:{means:{required:!0,type:Object},currency:{required:!0,type:Number}},components:{TableHeader:r,EmptyPlaceholder:o,MeansOfPaymentTableRow:u},data:function(){return{header:[{text:"Name",tooltip:"The name of your mean of payment"},{text:"Income",tooltip:"Use in income"},{text:"Outcome",tooltip:"Use in outcome"},{text:"Summary",tooltip:"Count to summary"},{text:"First entry",tooltip:"Date from which to add the starting balance"},{text:"Starting balance",tooltip:"Amount which to use for the first entry"},{}],content:{},contentCopy:{},submitted:!1}},computed:{equalContent:function(){return _.isEqual(this.content,this.contentCopy)},canSave:function(){var t=[];for(var e in this.content)t=t.concat(this.content[e].map((function(t){var e=t.name&&t.name.length<=32,n=t.first_entry_date&&(new Date(t.first_entry_date).getTime()<=new Date(t.date_limit).getTime()||null===t.date_limit),a=""!==t.first_entry_amount&&Math.abs(Number(t.first_entry_amount))<=99999999999.99;return e&&n&&a})));return!t.length||!!t.reduce((function(t,e){return t&&e}))}},methods:{create:function(){this.content[this.currency].push({id:0,currency_id:this.currency,income_mean:!1,outcome_mean:!1,count_to_summary:!1,first_entry_date:"",first_entry_amount:0,date_limit:null})},remove:function(t){this.content[this.currency].splice(t,1)},reset:function(){this.content=_.cloneDeep(this.contentCopy)},submit:function(){var t=this;this.submitted=!0,axios.post("/webapi/settings/means",{data:this.content}).then((function(e){var n=e.data;t.content=n.data,t.contentCopy=_.cloneDeep(n.data),t.submitted=!1})).catch((function(e){console.log(e),t.submitted=!1}))},refreshTooltip:function(){this.$nextTick((function(){updateTooltips()}))}},beforeMount:function(){this.content=_.cloneDeep(this.means),this.contentCopy=_.cloneDeep(this.means)},mounted:function(){this.refreshTooltip()},updated:function(){this.refreshTooltip()}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[n("div",[t.content[t.currency].length?n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table-themed responsive-table-hover"},[n("TableHeader",{attrs:{cells:t.header}}),t._v(" "),n("tbody",t._l(t.content[t.currency],(function(e,a){return n("MeansOfPaymentTableRow",{key:a,attrs:{index:a},on:{delete:function(e){return t.remove(a)}},model:{value:t.content[t.currency][a],callback:function(e){t.$set(t.content[t.currency],a,e)},expression:"content[currency][i]"}})})),1)],1)]):n("EmptyPlaceholder")],1),t._v(" "),n("hr",{staticClass:"hr"}),t._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4"},[n("button",{staticClass:"big-button-primary",attrs:{disabled:t.submitted},on:{click:t.create}},[t._v("\n                        New mean of payment\n                    ")])]),t._v(" "),n("div",{staticClass:"col-md-4 my-2 my-md-0"},[n("button",{staticClass:"big-button-danger",attrs:{disabled:t.submitted},on:{click:t.reset}},[t._v("\n                        Reset changes\n                    ")])]),t._v(" "),n("div",{staticClass:"col-md-4"},[n("button",{class:["big-button-success",!t.equalContent&&!t.submitted&&"text-stand-out"],attrs:{disabled:!t.canSave||t.submitted},on:{click:t.submit}},[t.submitted?n("span",{staticClass:"spinner-border spinner-border-sm",attrs:{role:"status","aria-hidden":"true"}}):n("div",[t._v("\n                            Save changes\n                        ")])])])])])])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-header-flex"},[n("div",{staticClass:"card-header-text"},[n("i",{staticClass:"fas fa-coins"}),t._v("\n                Means of Payment\n            ")])])}],!1,null,null,null);const m=a({components:{Loading:s,CategoriesComponent:l,MeansOfPaymentComponent:d.exports},data:function(){return{ready:!1,currentCurrency:1,currencies:[],categories:{},means:{}}},mounted:function(){var t=this;axios.get("/webapi/settings",{}).then((function(e){var n=e.data;t.currencies=n.currencies,t.categories=n.categories,t.means=n.means,t.currentCurrency=n.lastCurrency,t.ready=!0}))}},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("div",{staticClass:"card-header-flex"},[t._m(0),t._v(" "),t.ready?n("div",{staticClass:"d-flex"},[n("div",{staticClass:"h4 my-auto me-3"},[t._v("Currency:")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.currentCurrency,expression:"currentCurrency"}],staticClass:"form-control",on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.currentCurrency=e.target.multiple?n:n[0]}}},t._l(t.currencies,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                    "+t._s(e.ISO)+"\n                ")])})),0)]):t._e()]),t._v(" "),n("div",{staticClass:"card-body"},[t.ready?n("div",[n("CategoriesComponent",{attrs:{categories:t.categories,currency:t.currentCurrency}}),t._v(" "),n("MeansOfPaymentComponent",{staticClass:"mt-3",attrs:{means:t.means,currency:t.currentCurrency}})],1):n("Loading")],1)])}),[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card-header-text"},[n("i",{staticClass:"fas fa-cog"}),t._v("\n            Settings\n        ")])}],!1,null,null,null).exports}},e={};function n(a){var s=e[a];if(void 0!==s)return s.exports;var r=e[a]={exports:{}};return t[a](r,r.exports,n),r.exports}n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{Vue.component("settings-component",n(1416).Z);new Vue({el:"#app"})})()})();
//# sourceMappingURL=settings.js.map